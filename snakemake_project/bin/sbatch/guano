#!/bin/bash
#SBATCH --partition=Orion
#SBATCH --job-name=bat_quano
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=10
#SBATCH --mem=200gb
#SBATCH --time=02-00:00:00

#SBATCH --error=../slurm/%x_%j.err
#SBATCH --output=../slurm/%x_%j.out

################################################################
# author: TJ Rogers                                            #
#                                                              #
# Running snakemkake workflow.                                 #
################################################################
#### Load modules:
module purge
module load mambaforge/4.14

#### Activate snakemake environment:
mamba activate snakemake

#### Change into working directory:
cd ../../workflow

#### Create workflow dag:
snakemake --dag all | dot -Tsvg > report/dag.svg 

#### Create workflow report:
snakemake all --dry-run --printshellcmds

#### Run workflow:
snakemake all --cores all --use-conda --scheduler greedy --rerun-incomplete

# If you recieve a notice that directories or files are locked by snakemake, run the below script:
    #snakemake --unlock --cores all